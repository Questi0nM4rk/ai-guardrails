
## AI Guardrails - Code Standards

This project uses [ai-guardrails](https://github.com/Questi0nM4rk/ai-guardrails) for pedantic code enforcement.

### Philosophy

**Hard stops only.** No warnings, no suggestions. Everything is an error or it's ignored.

Pre-commit hooks run on every commit. If they fail, the commit is rejected.
Fix all errors before committing. Do not bypass hooks with `--no-verify`.

### Pre-commit Workflow

```
format -> stage -> checks -> commit
```

1. `format-and-stage` auto-formats and re-stages (local only, skipped in CI)
2. Security scans (gitleaks, detect-secrets, semgrep)
3. Linting (ruff, biome, shellcheck, etc.)
4. Type checking (strict mode)
5. Git hygiene (no commits to main, no large files)

### Language-Specific Rules

**Python:**
- `from __future__ import annotations` required in ALL files
- Type hints required on all function signatures
- Docstrings required on public functions/classes
- No bare `except:` - always specify exception type
- Use `X | None` not `Optional[X]`

**TypeScript/JavaScript:**
- Strict mode (`"strict": true` in tsconfig)
- No `any` type - use `unknown` and narrow
- No `console.log` in production code
- JSDoc on exported functions

**Shell (Bash):**
- `set -euo pipefail` at script start
- Quote all variables: `"$var"` not `$var`
- Use `[[` not `[` for conditionals
- Prefer portable POSIX syntax where possible

### Test Requirements

- Tests required for new functionality
- Test files must be named `test_*.py` or `*_test.py`
- Meaningful assertions (not just "no errors")
- No shared state between tests

### When Pre-commit Fails

1. Read the error message carefully
2. Fix the issue in your code (don't disable the check)
3. Stage the fix: `git add -u`
4. Commit again

Common fixes:
- Missing type hints -> Add them
- Missing docstring -> Add it
- Import order wrong -> Let ruff fix it (auto-staged)
- Trailing whitespace -> Auto-fixed by hooks
